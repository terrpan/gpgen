# GPGen - Golden Path Pipeline Generator

> A powerful tool for generating standardized GitHub Actions workflows with customization capabilities

## Disclaimer
Generated by AI, please review and modify as needed.

GPGen enables teams to create consistent, maintainable CI/CD pipelines by combining:
- **Golden Path Templates**: Battle-tested workflow templates for common project types
- **Kubernetes-style Manifests**: Familiar, declarative configuration approach
- **Flexible Customization**: Inject custom steps and environment-specific overrides
- **Schema Validation**: Ensure configuration correctness with strict/relaxed modes

## Vision

Transform CI/CD pipeline management from scattered YAML files to a centralized, template-driven approach that promotes best practices while maintaining flexibility for unique requirements.

## Key Features

### ğŸ¯ **Template-Driven Architecture**
- Pre-built golden path templates for Node.js, Go, Python, and more
- Template-specific input schemas with validation
- Extensible template system for custom project types

### ğŸ”§ **Intelligent Customization**
- Kubernetes-style manifest files (`apiVersion`/`kind` structure)
- Precise step positioning (before/after/replace patterns)
- Environment-specific configurations and overrides
- Custom step injection with full GitHub Actions compatibility

### ğŸ›¡ï¸ **Robust Validation**
- JSON Schema support with IDE integration
- Strict validation for production environments
- Relaxed validation for development workflows
- Comprehensive error reporting and suggestions

### ğŸŒ **Environment Awareness**
- Multi-environment support (dev/staging/production)
- Environment-specific input overrides
- Conditional step execution based on environment
- Secure secret management integration

## Project Status

### âœ… Phase 1: Foundation (COMPLETED)
- [x] **Manifest System**: Kubernetes-style YAML manifests with JSON schema validation
- [x] **Schema Validation**: Comprehensive validation with strict/relaxed modes and detailed error reporting
- [x] **Project Structure**: Modular Go architecture with proper separation of concerns

### âœ… Phase 2: Core Functionality (COMPLETED)
- [x] **CLI Interface**: Complete command-line tool with `init`, `validate`, and `generate` commands
- [x] **Template System**: Built-in golden path templates for Node.js, Go, and Python with input schemas
- [x] **Workflow Generator**: GitHub Actions YAML generation with template substitution and custom step positioning
- [x] **Environment Support**: Multi-environment workflows with input overrides and different triggers
- [x] **Custom Steps**: Flexible step injection with before/after/replace positioning patterns
- [x] **Comprehensive Testing**: Full test coverage for all components with integration tests

### ğŸš§ Phase 3: Advanced Features (PLANNED)
- [ ] **Template Inheritance**: Allow templates to extend other templates
- [ ] **Matrix Builds**: Support for complex build matrices across multiple environments
- [ ] **Secret Management**: Integration with GitHub secrets and external secret providers
- [ ] **Conditional Logic**: Advanced conditional step execution based on file changes, labels, etc.
- [ ] **Plugin System**: Support for custom template plugins and extensions

## Available Commands

### `gpgen init`
Create a new pipeline manifest from a template:

```bash
# Initialize with built-in template
gpgen init node-app my-project

# List available templates
gpgen init --list-templates
```

### `gpgen validate`
Validate a manifest file:

```bash
# Basic validation
gpgen validate manifest.yaml

# Strict validation for production
gpgen validate manifest.yaml --strict

# Quiet mode (errors only)
gpgen validate manifest.yaml --quiet
```

### `gpgen generate`
Generate GitHub Actions workflows:

```bash
# Generate all environments
gpgen generate manifest.yaml

# Generate specific environment
gpgen generate manifest.yaml --environment production

# Dry run (preview without creating files)
gpgen generate manifest.yaml --dry-run

# Custom output directory
gpgen generate manifest.yaml --output .workflows/
```

## Built-in Templates

GPGen includes production-ready templates for common project types:

### Node.js Template (`node-app`)
**Perfect for**: Web applications, APIs, npm packages
**Included Steps**: Checkout, Node.js setup, dependency installation, testing, building
**Configurable Inputs**:
- `nodeVersion`: Node.js version (default: "18")
- `packageManager`: npm, yarn, or pnpm (default: "npm")
- `testCommand`: Test execution command (default: "npm test")
- `buildCommand`: Build command (default: "npm run build")
- `cacheStrategy`: Dependency caching strategy (default: "npm")

### Go Template (`go-service`)
**Perfect for**: Microservices, CLI tools, backend services
**Included Steps**: Checkout, Go setup, module download, testing, building
**Configurable Inputs**:
- `goVersion`: Go version (default: "1.21")
- `testCommand`: Test execution command (default: "go test ./...")
- `buildCommand`: Build command (default: "go build -o bin/app")
- `lintEnabled`: Enable golangci-lint (default: true)

### Python Template (`python-app`)
**Perfect for**: Web applications, data processing, ML services
**Included Steps**: Checkout, Python setup, dependency installation, testing
**Configurable Inputs**:
- `pythonVersion`: Python version (default: "3.11")
- `dependencyFile`: Requirements file (default: "requirements.txt")
- `testCommand`: Test execution command (default: "pytest")
- `installCommand`: Install command (default: "pip install -r requirements.txt")

### Custom Templates
You can create your own templates by adding them to the templates directory. Each template consists of:
- Template definition with steps and input schema
- Input validation rules and defaults
- Environment-specific trigger configurations

## Real-World Example

```yaml
apiVersion: gpgen.dev/v1
kind: Pipeline
metadata:
  name: ecommerce-api
  annotations:
    gpgen.dev/validation-mode: strict
    gpgen.dev/description: "Production-ready Node.js API pipeline"
spec:
  template: node-app
  inputs:
    nodeVersion: "18"
    packageManager: npm
    testCommand: "npm run test:ci"

  # Custom steps for security and compliance
  customSteps:
    - name: security-scan
      position: after:test
      uses: securecodewarrior/github-action-add-sarif@v1
      with:
        sarif-file: security-results.sarif

    - name: dependency-check
      position: before:build
      run: npm audit --audit-level high

    - name: custom-deploy
      position: replace:deploy
      uses: ./.github/actions/custom-deploy
      with:
        environment: ${{ env.ENVIRONMENT }}

  # Environment-specific configurations
  environments:
    staging:
      inputs:
        testCommand: "npm run test:integration"

    production:
      inputs:
        nodeVersion: "20"
        testCommand: "npm run test:all"
      customSteps:
        - name: performance-test
          position: after:test
          run: npm run test:performance
```

This manifest generates environment-specific workflows with security scanning, dependency checks, and custom deployment logic while maintaining the golden path structure.

## Project Structure

```
â”œâ”€â”€ pkg/manifest/           # Core manifest parsing and validation
â”œâ”€â”€ pkg/templates/          # Golden path templates
â”œâ”€â”€ pkg/generator/          # Workflow generation engine
â”œâ”€â”€ cmd/gpgen/             # CLI application
â”œâ”€â”€ schemas/v1/            # JSON schemas for validation
â”œâ”€â”€ docs/decisions/        # Architecture Decision Records
â””â”€â”€ examples/              # Example manifest files
```

## Project Status & Roadmap

### ğŸ‰ **Phase 1: Foundation (COMPLETED)**

**Core Infrastructure**
- [x] **Architecture Design**: Comprehensive ADR documentation with all design decisions
- [x] **Manifest Schema**: Kubernetes-style API with proper versioning (`apiVersion`/`kind`)
- [x] **Parsing Engine**: Complete YAML manifest parsing with structured validation
- [x] **Validation System**: Multi-mode validation (strict/relaxed) with detailed error reporting
- [x] **Custom Steps**: Advanced positioning system (before/after/replace patterns)
- [x] **Environment Support**: Multi-environment configurations with inheritance
- [x] **JSON Schema**: IDE-ready schema definition for autocompletion
- [x] **Test Coverage**: Comprehensive test suite (15+ test cases) with edge case handling
- [x] **Examples**: Real-world manifest examples demonstrating all features

**Technical Foundation**
- [x] Go module setup with proper dependency management
- [x] Structured package architecture (manifest, templates, generator, CLI)
- [x] Documentation framework with decision tracking

### ğŸ‰ **Phase 2: Core Functionality (COMPLETED)**

**CLI Interface**
- [x] **Command Structure**: Implemented `gpgen init`, `generate`, `validate` commands
- [x] **Flag System**: Comprehensive flag support (--strict, --dry-run, --environment, etc.)
- [x] **Error Handling**: User-friendly error messages and suggestions
- [x] **Help System**: Complete help documentation for all commands

**Template System**
- [x] **Node.js Template**: Production-ready workflow with testing, building, caching
- [x] **Go Service Template**: Go-specific pipeline with modules, testing, building
- [x] **Python Template**: Python application pipeline with virtual environments
- [x] **Template Schema**: Input validation schemas for each template type
- [x] **Template Discovery**: Automatic template loading and validation

**Workflow Generation**
- [x] **Template Engine**: Load templates and inject custom steps with input substitution
- [x] **Step Positioning**: Fully implemented before/after/replace logic with smart matching
- [x] **Environment Processing**: Generate environment-specific workflows with different triggers
- [x] **Output Management**: GitHub Actions YAML generation with proper formatting

### ğŸ”® **Phase 3: Advanced Features (PLANNED)**

**Enterprise Features**
- [ ] **Template Inheritance**: Compose templates from base templates
- [ ] **Conditional Execution**: Environment and input-based conditionals
- [ ] **Matrix Builds**: Multi-platform and multi-version testing
- [ ] **Secret Management**: Secure secret injection and rotation
- [ ] **Policy Enforcement**: Organization-wide pipeline policies

**Developer Experience**
- [ ] **IDE Integration**: VS Code extension with manifest editing support
- [ ] **Template Marketplace**: Public registry of community templates
- [ ] **Debugging Tools**: Pipeline testing and troubleshooting utilities
- [ ] **Migration Tools**: Convert existing workflows to GPGen manifests

**Integration & Ecosystem**
- [ ] **CI/CD Platform Support**: GitLab CI, Azure DevOps, Jenkins adapters
- [ ] **Monitoring Integration**: Pipeline observability and metrics
- [ ] **Security Scanning**: Built-in vulnerability and compliance checking
- [ ] **Documentation Generation**: Automatic pipeline documentation

### ğŸ“Š **Current Progress: 85% Complete (Core MVP)**

- âœ… **Foundation**: Solid architecture and core parsing (100%)
- âœ… **CLI & Templates**: Fully functional CLI with 3 templates (100%)
- ğŸ“‹ **Advanced Features**: Planning phase (0%)

## Getting Started

### Prerequisites

- **Go 1.21+**: Required for building and running GPGen
- **Git**: For version control and repository management
- **GitHub CLI** (optional): For enhanced GitHub integration

### Installation

#### From Source
```bash
# Clone the repository
git clone https://github.com/your-org/gpgen.git
cd gpgen

# Install dependencies
go mod download

# Build the CLI
go build -o bin/gpgen ./cmd/gpgen

# Add to your PATH (optional)
export PATH=$PATH:$(pwd)/bin
```

#### Using Go Install
```bash
# Install directly from source
go install github.com/your-org/gpgen/cmd/gpgen@latest
```

### First Steps

1. **Initialize a new project**:
   ```bash
   gpgen init --template node-app --name my-awesome-app
   ```

2. **Customize your manifest** (`manifest.yaml`):
   - Add custom steps for your specific needs
   - Configure environment-specific settings
   - Set validation mode (strict for production)

3. **Generate your workflow**:
   ```bash
   gpgen generate
   ```

4. **Validate your configuration**:
   ```bash
   gpgen validate --strict
   ```

### Development Workflow

```bash
# Run all tests
go test ./...

# Run tests with coverage
go test -cover ./...

# Run tests verbosely with race detection
go test -v -race ./...

# Lint code (requires golangci-lint)
golangci-lint run

# Format code
go fmt ./...
```

## Architecture Overview

GPGen follows a modular, extensible architecture designed for scalability and maintainability:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CLI Layer     â”‚    â”‚  Web Interface  â”‚    â”‚   IDE Plugin    â”‚
â”‚  (cmd/gpgen)    â”‚    â”‚   (Future)      â”‚    â”‚   (Future)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚              Core Engine (pkg/)                     â”‚
          â”‚                                                     â”‚
          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
          â”‚  â”‚  Manifest   â”‚  â”‚  Templates  â”‚  â”‚  Generator  â”‚ â”‚
          â”‚  â”‚   Parser    â”‚  â”‚   Manager   â”‚  â”‚   Engine    â”‚ â”‚
          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
          â”‚                                                     â”‚
          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
          â”‚  â”‚ Validation  â”‚  â”‚   Schema    â”‚  â”‚   Output    â”‚ â”‚
          â”‚  â”‚   Engine    â”‚  â”‚  Registry   â”‚  â”‚  Formatter  â”‚ â”‚
          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚              Data Layer                             â”‚
          â”‚                                                     â”‚
          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
          â”‚  â”‚   Golden    â”‚  â”‚    JSON     â”‚  â”‚   Template  â”‚ â”‚
          â”‚  â”‚   Path      â”‚  â”‚   Schema    â”‚  â”‚    Cache    â”‚ â”‚
          â”‚  â”‚ Templates   â”‚  â”‚   Files     â”‚  â”‚             â”‚ â”‚
          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Core Components

- **Manifest Package** (`pkg/manifest/`): Handles parsing, validation, and schema enforcement
- **Template Package** (`pkg/templates/`): Manages golden path templates and their schemas
- **Generator Package** (`pkg/generator/`): Orchestrates workflow generation from manifests and templates
- **CLI Package** (`cmd/gpgen/`): Provides command-line interface for user interaction

### Design Principles

1. **Separation of Concerns**: Each package has a single, well-defined responsibility
2. **Extensibility**: Plugin architecture for custom templates and validators
3. **Type Safety**: Strong typing with comprehensive validation
4. **Performance**: Efficient parsing and generation with caching
5. **Testability**: High test coverage with dependency injection

For detailed architectural decisions, see the [ADR documentation](docs/decisions/).

## Contributing

We welcome contributions! Here's how to get started:

### Development Setup

1. **Fork and Clone**:
   ```bash
   git clone https://github.com/YOUR_USERNAME/gpgen.git
   cd gpgen
   ```

2. **Install Dependencies**:
   ```bash
   go mod download
   ```

3. **Verify Setup**:
   ```bash
   go test ./...
   ```

### Contribution Guidelines

#### ğŸ› **Bug Reports**
- Use the issue template
- Include manifest examples that reproduce the issue
- Provide expected vs actual behavior

#### âœ¨ **Feature Requests**
- Start with a discussion in issues
- Include use cases and examples
- Consider backward compatibility

#### ğŸ”§ **Code Contributions**
1. **Create a feature branch**: `git checkout -b feature/amazing-feature`
2. **Follow TDD**: Write tests first, then implementation
3. **Maintain coverage**: Ensure `go test -cover ./...` stays above 90%
4. **Update documentation**: Include relevant ADRs and README updates
5. **Submit PR**: Use the pull request template

#### ğŸ“ **Adding Templates**
1. Create template in `templates/` directory
2. Add JSON schema for template inputs
3. Include comprehensive examples
4. Write tests for template generation
5. Update template registry

### Code Standards

- **Formatting**: Use `go fmt` and `golangci-lint`
- **Testing**: Test-driven development with comprehensive coverage
- **Documentation**: Include godoc comments for public APIs
- **Error Handling**: Use structured errors with helpful messages
- **Logging**: Use structured logging for debugging

### Decision Making

Major changes require an Architecture Decision Record (ADR):
1. Create a new ADR in `docs/decisions/`
2. Follow the established format
3. Include context, options, and decision rationale
4. Submit for review before implementation

## Community & Support

- **GitHub Issues**: Bug reports and feature requests
- **Discussions**: Questions and community support
- **Documentation**: Comprehensive guides and API docs
- **Examples**: Real-world manifest examples and templates

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---
